<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8" />
<title>Hacker Simulation</title>
<style>
    html, body {
        margin: 0;
        height: 100%;
        background: #000;
        overflow: hidden;
        font-family: Consolas, monospace;
        color: #0f0;
    }

    /* 粒子背景 */
    canvas#particles {
        position: fixed;
        inset: 0;
        z-index: -3;
    }

    /* 代码雨 */
    canvas#rain {
        position: fixed;
        inset: 0;
        z-index: -2;
    }

    /* 终端窗口 */
    #terminal {
        position: absolute;
        top: 5%;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        height: 80%;
        padding: 20px;
        background: rgba(0, 20, 0, 0.35);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0,255,0,0.2);
        border-radius: 20px;
        box-shadow: 0 0 25px #0f05 inset, 0 0 15px #0f05;
        overflow-y: auto;
        color: #0f0;
        font-size: 16px;
        z-index: 2;
    }

    /* 打字光标 */
    .cursor {
        display: inline-block;
        width: 10px;
        height: 20px;
        background: #0f0;
        animation: blink 0.6s infinite;
    }
    @keyframes blink {
        0%, 50% { opacity: 1; }
        50%, 100% { opacity: 0; }
    }

    /* 点击弹窗 */
    .popup {
        position: absolute;
        min-width: 260px;
        padding: 20px;
        background: rgba(0,40,0,0.85);
        border: 1px solid #0f0;
        border-radius: 10px;
        box-shadow: 0 0 20px #0f0;
        color: #0f0;
        font-size: 14px;
        backdrop-filter: blur(6px);
        animation: fadeIn .3s ease;
        z-index: 10;
    }
    @keyframes fadeIn { from { opacity: 0; transform: scale(.8); } }

    /* HUD 扫描 */
    #hud {
        position: fixed;
        top: 10%;
        right: 3%;
        width: 180px;
        height: 140px;
        background: rgba(0,30,0,0.4);
        border: 1px solid #0f0;
        border-radius: 10px;
        box-shadow: 0 0 15px #0f08;
        overflow: hidden;
        z-index: 5;
    }
    #hudScan {
        position: absolute;
        width: 100%;
        height: 20px;
        background: linear-gradient(to bottom, transparent, rgba(0,255,0,.4), transparent);
        animation: scan 2s linear infinite;
    }
    @keyframes scan {
        0% { top: -20px; }
        100% { top: 140px; }
    }

    /* 鼠标光点 */
    #light {
        position: fixed;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        pointer-events: none;
        background: radial-gradient(#0f05, transparent);
        mix-blend-mode: screen;
        z-index: 20;
    }

    /* 蓝屏 */
    #bsod {
        position: fixed;
        inset: 0;
        background: #001b7a;
        color: #fff;
        font-family: Consolas;
        display: none;
        padding: 40px;
        z-index: 999;
        font-size: 22px;
        line-height: 1.6;
    }
</style>
</head>

<body>
<canvas id="particles"></canvas>
<canvas id="rain"></canvas>

<div id="terminal"></div>

<div id="hud">
    <div id="hudScan"></div>
</div>

<div id="light"></div>

<div id="bsod">
    <h1>:(</h1>
    <p>你的系统遇到问题，需要重启。</p>
    <p>正在收集错误信息 ... 完成。</p>
    <p>错误代码：FAKE_SECURITY_BREAK</p>
</div>

<script>
/* 粒子背景 */
const pCanvas = document.getElementById("particles");
const pCtx = pCanvas.getContext("2d");
let pArray = [];
function resize() {
    pCanvas.width = innerWidth;
    pCanvas.height = innerHeight;
}
window.onresize = resize;
resize();
for (let i = 0; i < 120; i++) {
    pArray.push({
        x: Math.random() * innerWidth,
        y: Math.random() * innerHeight,
        r: Math.random() * 2,
        dx: (Math.random()-0.5) * 0.4,
        dy: (Math.random()-0.5) * 0.4
    });
}
function drawParticles() {
    pCtx.clearRect(0,0,pCanvas.width,pCanvas.height);
    pCtx.fillStyle = "#0f0";
    pArray.forEach(p => {
        p.x += p.dx; p.y += p.dy;
        if(p.x<0||p.x>innerWidth) p.dx*=-1;
        if(p.y<0||p.y>innerHeight) p.dy*=-1;
        pCtx.fillRect(p.x,p.y,p.r,p.r);
    });
    requestAnimationFrame(drawParticles);
}
drawParticles();

/* 代码雨 */
const rCanvas = document.getElementById("rain");
const rCtx = rCanvas.getContext("2d");
function rainResize() {
    rCanvas.width = innerWidth;
    rCanvas.height = innerHeight;
}
rainResize();
const font = 14;
const columns = rCanvas.width / font;
let drops = [];
for(let i=0;i<columns;i++) drops[i] = Math.random() * rCanvas.height;
function drawRain() {
    rCtx.fillStyle = "rgba(0,0,0,0.1)";
    rCtx.fillRect(0,0,rCanvas.width,rCanvas.height);
    rCtx.fillStyle = "#0f0";
    for(let i=0;i<drops.length;i++){
        let text = String.fromCharCode(0x30A0 + Math.random()*96);
        rCtx.fillText(text, i*font, drops[i]*font);
        drops[i]++;
        if(drops[i]*font > rCanvas.height) drops[i] = 0;
    }
    requestAnimationFrame(drawRain);
}
drawRain();

/* 打字机（含错字修复） */
const terminal = document.getElementById("terminal");
const lines = [
    "> 初始化安全模块……",
    "> 建立量子加密通道…… OK",
    "> 载入代理节点：44 个",
    "> 节点延迟均衡……完成",
    "> 连接深度网络主机……成功",
    "> 正在部署内存溢出攻击向量……",
    "> 执行远程注入…… 96%",
    "> 正在读取系统结构……",
    "> 触发系统监控警告！",
    "> 护盾反击开始：准备震动",
    "> === 屏幕震动启动 ===",
    "> 擦除访问记录……成功",
    "> 系统即将保护性蓝屏……"
];
let idx = 0;
let charIdx = 0;
let wrongChance = 0.12;
let wrongChar = "";

function type() {
    if(idx >= lines.length) {
        setTimeout(() => {
            document.body.style.animation = "shake 0.2s infinite";
            showBSOD();
        }, 800);
        return;
    }
    let line = lines[idx];

    let out = line.substring(0, charIdx);

    // 错字场景
    if (Math.random() < wrongChance && wrongChar === "") {
        wrongChar = String.fromCharCode(33 + Math.random()*60);
        out += wrongChar;
    } else if (wrongChar !== "") {
        // 修正错字
        wrongChar = "";
    }

    terminal.innerHTML = terminal.innerHTML.replace(/<span.*$/, "");
    terminal.innerHTML += out + '<span class="cursor"></span>';

    if (wrongChar !== "") {
        setTimeout(()=>type(), 80);
        return;
    }

    charIdx++;
    if(charIdx > line.length) {
        idx++;
        charIdx = 0;
        terminal.innerHTML += "<br>";
        setTimeout(()=>type(), 300);
    } else setTimeout(()=>type(), 40);
}
type();

/* 点击弹窗 */
document.addEventListener("click", e=>{
    const div = document.createElement("div");
    div.className = "popup";
    div.style.left = e.clientX + "px";
    div.style.top = e.clientY + "px";
    div.innerHTML = "⚠ SYSTEM SCAN<br>入侵行为已记录<br>位置坐标：" + e.clientX + "," + e.clientY;
    document.body.appendChild(div);
    setTimeout(()=>div.remove(), 1500);
});

/* 鼠标光点 */
const light = document.getElementById("light");
document.addEventListener("mousemove", e=>{
    light.style.left = (e.clientX - 12)+"px";
    light.style.top = (e.clientY - 12)+"px";
});

/* 蓝屏 */
function showBSOD() {
    setTimeout(()=>{
        document.getElementById("bsod").style.display = "block";
    }, 1500);
}
</script>
</body>
</html>
